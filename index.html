<!DOCTYPE html>
<html>
<head>
<title>W3.CSS Template</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
body, html {
  height: 100%;
  font-family: "Inconsolata", sans-serif;
}

.bgimg {
  background-position: center;
  background-size: cover;
  background-image: url("figures/10-captivating-facts-about-galactic-magnetic-fields-1692782059.jpg");
  min-height: 75%;
}

.menu {
  display: none;
}
</style>
</head>
<body>

<!-- Links (sit on top) -->
<div class="w3-top">
  <div class="w3-row w3-padding w3-black">
    <div class="w3-col s3">
      <a href="#" class="w3-button w3-block w3-black">HOME</a>
    </div>
    <div class="w3-col s3">
      <a href="#about" class="w3-button w3-block w3-black">ABOUT</a>
    </div>
   <div class="w3-col s3">
      <a href="#task1" class="w3-button w3-block w3-black">TASKS</a>
    </div>
    <div class="w3-col s3">
        <a href="#menu" class="w3-button w3-block w3-black">REFERENCES</a>
      </div>
  </div>
</div>

<!-- Header with image -->
<header class="bgimg w3-display-container w3-grayscale-min" id="home">
  <div class="w3-display-bottomleft w3-center w3-padding-large w3-hide-small">
    <span class="w3-tag">P464 MHD Computation Project</span>
  </div>
  <div class="w3-display-middle w3-center">
    <span class="w3-text-black" style="font-size:90px">GALACTIC<br>DYNAMOS</span>
  </div>
  <div class="w3-display-bottomright w3-center w3-padding-large">
    <span class="w3-text-white">Done by Gayathri K,2011067</span>
  </div>
</header>

<!-- Add a background color and large text to the whole page -->
<div class="w3-sand w3-grayscale w3-large">


<!-- About Container -->
<div class="w3-container" id="about">
  <div class="w3-content" style="max-width:700px">
      <h5 class="w3-center w3-padding-64"><span class="w3-tag w3-wide">ABOUT THE PROJECT</span></h5>
      <p>This project investigates the dynamics of magnetic fields within galaxies, focusing on the principles of galactic dynamo theory. Dynamo theory elucidates the mechanisms responsible for the sustained generation and evolution of magnetic fields over cosmic timescales.</p>
      <p>Through computational simulations and analysis, we explore the interplay between fluid motion and magnetic energy, utilizing Python programming language to solve the governing equations of magnetohydrodynamics (MHD). Specifically, our simulations delve into kinematic dynamos within galaxies, examining phenomena such as differential rotation, turbulence, and magnetic field amplification.</p>
                

  </div>
</div>

      <!-- End Subcontainer: Kinematic Dynamos in Galaxies -->
  </div>
</div>

<div class="w3-container" id="meth">
  <div class="w3-content" style="max-width:700px">
      <h5 class="w3-center w3-padding-64"><span class="w3-tag w3-wide">NUMERICAL METHODS</span></h5>
      <p>This project focuses on computational simulations of galactic dynamos, exploring the intricate dynamics of magnetic fields within galaxies. Using Python, the equations governing magnetohydrodynamics (MHD) are solved to understand how magnetic fields evolve and interact with the surrounding astrophysical environment. By analyzing the results obtained from these simulations, insights into the generation and maintenance of magnetic fields in galaxies can be gained. The project includes detailed documentation, including Jupyter notebooks hosted on GitHub, and a comprehensive project report in PDF format.</p>
      <p>I have to solve the equations in R. The codes are written in python. More details on the codes I implemented are Given in the following sections.</p>
    
      <!-- Subcontainer: Kinematic Dynamos in Galaxies -->
      <div class="subcontainer">
        <h2>Using ghost zones for boundary conditions</h2>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <p>In computational physics and engineering, especially in simulations involving partial differential equations (PDEs), boundary conditions play a crucial role in defining the behavior of the system at the boundaries of the computational domain. One common approach to implement boundary conditions is through the use of ghost zones or ghost cells.</p>
<h3>Concept:</h3>
<p>The idea behind ghost zones is to extend the computational domain by adding additional grid points adjacent to the boundaries. These additional grid points, called ghost cells or ghost zones, are used to enforce boundary conditions without directly affecting the original domain.</p>
<h3>Implementation:</h3>
<p>When implementing ghost zones, the values of variables at the ghost cells are typically determined based on the specified boundary conditions. These values act as placeholders and are updated iteratively during the simulation to maintain consistency with the boundary conditions.</p>
<h3>Types of Boundary Conditions:</h3>
<p>Ghost zones can be used to implement various types of boundary conditions, including:</p>
<ul>
  <li><strong>Dirichlet Boundary Conditions:</strong> In this case, the values at the ghost cells are set to specific prescribed values.</li>
  <li><strong>Neumann Boundary Conditions:</strong> Here, the values at the ghost cells are determined based on the derivative of the solution at the boundary.</li>
  <li><strong>Periodic Boundary Conditions:</strong> For periodic domains, the values at the ghost cells are obtained by wrapping around the values from the opposite boundary.</li>
  <li><strong>Robin Boundary Conditions:</strong> These conditions involve a combination of Dirichlet and Neumann conditions, where the values at the ghost cells are determined by a linear combination of the solution and its derivative at the boundary.</li>
</ul>
<h3>Advantages:</h3>
<p>Using ghost zones for boundary conditions offers several advantages:</p>
<ul>
  <li>It allows for a consistent and systematic treatment of boundary conditions across different types of simulations.</li>
  <li>It enables the use of standard numerical methods within the computational domain without modification.</li>
  <li>It facilitates parallelization and optimization strategies by maintaining a regular grid structure.</li>
</ul>
<p>Overall, ghost zones provide a flexible and efficient framework for incorporating boundary conditions in computational simulations, making them essential in various fields of scientific computing.</p>
       
      <div class="subcontainer">
          <h2>6th order finite differencing</h2>
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
          <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
          </head>
          <body>
       
          <p>The 6th order finite difference approximation for the second derivative \( f'' \) of a function \( f(x) \) is given by:</p>
          <blockquote>
          \[ f''(x) \approx \frac{-f(x + 3h) + 9f(x + 2h) - 45f(x + h) + 45f(x - h) - 9f(x - 2h) + f(x - 3h)}{h^2} \]
          </blockquote>
          <p>Similarly, the 6th order finite difference approximation for the first derivative \( f' \) of a function \( f(x) \) is:</p>
          <blockquote>
          \[ f'(x) \approx \frac{-\frac{1}{60}f(x + 3h) + \frac{3}{20}f(x + 2h) - \frac{3}{4}f(x + h) + \frac{3}{4}f(x - h) - \frac{3}{20}f(x - 2h) + \frac{1}{60}f(x - 3h)}{h} \]
          </blockquote>
          <p>Where \( h \) is the step size between the discrete points.</p>
      </div>
      <div class="subcontainer">
        <h2>4th order Runge-Kutta methods</h2>
        <p>The Runge-Kutta 4th order (RK4) method is a numerical technique used to solve ordinary differential equations (ODEs). It provides a balance between accuracy and computational complexity, making it one of the most popular methods for solving ODEs numerically.</p>

<p>The general form of the RK4 method for solving an initial value problem with a first-order ODE is:</p>
<blockquote>
\[ y_{n+1} = y_n + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4) \]
</blockquote>
<p>Where:</p>
<ul>
<li>\( y_n \) is the approximation of the solution at time \( t_n \).</li>
<li>\( h \) is the step size.</li>
<li>\( k_1, k_2, k_3, \) and \( k_4 \) are slopes determined at different points using the function \( f(t, y) \) representing the ODE.</li>
</ul>
<p>The algorithm is as follows:</p>
<ol>
<li>Compute \( k_1 \) using the function \( f(t_n, y_n) \).</li>
<li>Compute \( k_2 \) using the function \( f(t_n + \frac{h}{2}, y_n + \frac{h}{2}k_1) \).</li>
<li>Compute \( k_3 \) using the function \( f(t_n + \frac{h}{2}, y_n + \frac{h}{2}k_2) \).</li>
<li>Compute \( k_4 \) using the function \( f(t_n + h, y_n + hk_3) \).</li>
<li>Update the solution \( y_{n+1} \) using the weighted average of the slopes \( k_1, k_2, k_3, \) and \( k_4 \).</li>
</ol>
<p>The RK4 method offers relatively high accuracy compared to simpler methods like Euler's method, making it suitable for a wide range of applications in science and engineering.</p>

    </div>
      <!-- End Subcontai<ner: Kinematic Dynamos in Galaxies -->
  </div>
</div>
  
  
  
  <div class="w3-container" id="task1">
    <div class="w3-content" style="max-width:700px">
    <h5 class="w3-center w3-padding-64"><span class="w3-tag w3-wide">TASK 1</span></h5>
    <h3>Aim</h3>

<p>The aim of this study is to solve the diffusion equation in the radial coordinate \( r \). Our primary objective is to determine the spatial and temporal derivatives of the mean magnetic field components \( \overline{B_r} \) and \( \overline{B_{\phi}} \). Subsequently, we aim to ascertain the mean magnetic field value and employ an exponential decay model to discern the decay constant. Through this investigation, we seek to explore the evolution of the magnetic field magnitude and the exponential decay rate. Furthermore, our analysis extends to examining the spatial solution for \( \overline{B_r} \) and \( \overline{B_{\phi}} \), as well as calculating the pitch angle of the mean magnetic field denoted by \( p \). Additionally, we explore various boundary conditions and seed fields to assess their impact on the obtained results.</p>
<h3>Equations</h3>
<p>For this task, we address the diffusion equation while omitting the terms involving \( \nabla \times (\overline{V} \times \overline{B}) \) and \( \alpha \). Consequently, the equations to solve become:</p>

<p>For \( \overline{B_r} \):</p>
\[ \frac{\partial \overline{B_r}}{\partial t} = \eta_t \left[ \frac{\partial}{\partial r} \left( \frac{1}{r} \frac{\partial}{\partial r}(r \overline{B_r}) \right) + \frac{\partial^2 \overline{B_r}}{\partial z^2} \right] \]

<p>For \( \overline{B_{\phi}} \):</p>
\[ \frac{\partial \overline{B_{\phi}}}{\partial t} = \eta_t \left[ \frac{\partial}{\partial r} \left( \frac{1}{r} \frac{\partial}{\partial r}(r \overline{B_{\phi}}) \right) + \frac{\partial^2 \overline{B_{\phi}}}{\partial z^2} \right] \]

<p>Since both \( \overline{B_r} \) and \( \overline{B_{\phi}} \) share the same equation form, we generalize it to:</p>
\[ \frac{\partial \overline{B}}{\partial t} = \eta_t \left[ \frac{\partial}{\partial r} \left( \frac{1}{r} \frac{\partial}{\partial r}(r \overline{B}) \right) + \frac{\partial^2 \overline{B}}{\partial z^2} \right] \]

<p>Under the no-\( z \) approximation, the equations for \( \overline{B_r}(r) \) and \( \overline{B_{\phi}}(r) \) simplify to:</p>
\[ \frac{\partial \overline{B}}{\partial t} = \eta_t \left[ \frac{\partial^2 \overline{B}}{\partial r^2} + \frac{1}{r} \frac{\partial \overline{B}}{\partial r} - \frac{\overline{B}}{r^2} - \frac{\pi^2}{4 h^2} \overline{B} \right] \]

<p>Expanding the equation yields:</p>
\[ \frac{\partial \overline{B}}{\partial t} = \eta_t \left[ \frac{\partial^2 \overline{B}}{\partial r^2} + \frac{1}{r} \frac{\partial \overline{B}}{\partial r} - \frac{\overline{B}}{r^2} - \frac{\pi^2}{4 h^2} \overline{B} \right] \]

<p>These are the equations we need to solve for task 1.</p>
<h3>Method</h3>

<p>The equations we aim to solve take the form:</p>
\[ \frac{\partial \overline{B_i}}{\partial t} = \eta_t\left(\frac{\partial}{\partial r}\left[\frac{1}{r}\frac{\partial}{\partial r}\left(r\overline{B_i}\right)\right] - \frac{\pi^2 \overline{B_i}}{4h^2}\right)\]
<p>Here, \(i\) represents both \(r\) and \( \phi \).</p>

<p>A sinusoidal initial condition is imposed on both \( \overline{B_r} \) and \( \overline{B_{\phi}} \). The spatial derivatives were calculated with this initial condition and a radial step size \( dr \). We employed the sixth-order finite differencing method. To ensure accuracy, we extended the computational domain by adding three cells to the left and right sides of the boundary, employing relative antisymmetric ghost cells enforcing the simplest boundary condition, i.e., 0 on both sides. The output of finite differencing was then utilized in the time derivative function, and we performed RK4 integration.</p>

<p>Subsequently, we changed the initial condition and used it to evolve the \( \overline{B_{\phi}} \) field. The implications of different seed magnetic fields were studied by comparing the time evolution of \( \overline{B_{\phi}} \) and \( \overline{B_r} \).</p>

<p>Once \( \overline{B_{\phi}} \) and \( \overline{B_r} \) are solved for, the pitch angle can be calculated using the formula:</p>
\[\tan(p) = \frac{\overline{B_r}}{\overline{B_{\phi}}}\]
<p>where \( -\frac{\pi}{2} < p \leq \frac{\pi}{2} \).</p>

<p>From \( \overline{B_{\phi}} \) and \( \overline{B_r} \), we calculate the total mean magnetic field:</p>
\[\overline{B} = \sqrt{\overline{B_r}^2 + \overline{B_{\phi}}^2}\]

<p>The time evolution of this field is studied. Subsequently, we fit the values of the field obtained into an exponential decay model. To achieve this, we plot the \( \log_{10} \) values of \( B \) on the \( y \) axis and time on the \( x \) axis; the slope of this plot provides the value of the decay constant. Initially, we plot this for a single \( r \), then we plot a decay constant vs \( r \) plot.</p>
<h3>Results</h3>

<img src="figures/output.png" style="width:100%;max-width:1000px;margin-top:32px;">
<p>This image depicts the initial condition provided for \( \overline{B_r} \), which is a simple sine function. Subsequently, this condition is altered while solving for \( \overline{B_{\phi}} \), allowing us to examine the influence of seed fields over time.</p>

<img src="figures/manysine.png" style="width:100%;max-width:1000px;margin-top:32px;">
<p>The plot illustrates the time evolution of \( \overline{B_r} \). It is evident that the magnetic field decays as time progresses.</p>


<img src="figures/B_r_t_final.gif" style="width:100%;max-width:1000px;margin-top:32px;">
<p>The animation presents the time evolution of \( \overline{B_r} \).</p>

<img src="figures/twoini.png" style="width:100%;max-width:1000px;margin-top:32px;">
<p>To examine the impact of the choice of initial condition on field evolution, we employ two different initial functions, as depicted. It is important to note that these functions also have different boundary conditions.</p>

<img src="figures/twoinires.png" style="width:100%;max-width:1000px;margin-top:32px;">
<p>This plot illustrates the time evolution of two magnetic fields with different initial conditions.</p>


<img src="figures/B_mean_final.gif" style="width:100%;max-width:1000px;margin-top:32px;">
<p>This animation illustrates the time evolution of the mean magnetic field. After obtaining \( \overline{B_r} \) and \( \overline{B_{\phi}} \), we calculate the mean magnetic field using the theory discussed earlier. Due to the different initial values of \( \overline{B_{\phi}} \), the boundary condition is not satisfied on the right side.</p>


<img src="figures/pitch1_final.gif" style="width:100%;max-width:1000px;margin-top:32px;">
<p>The pitch angles found are plotted against radius and evolved over time, as shown.</p>

<img src="figures/spattial.png" style="width:100%;max-width:1000px;margin-top:32px;">
<p>This graph showcases the magnetic field strength over different \(r\), which follows an exponentially decaying trend.</p

<img src="figures/loglog.png" style="width:100%;max-width:1000px;margin-top:32px;">
<p>Here we plot the logarithm of the mean magnetic field against time to determine the decay constant. This analysis is conducted for a single radius. The decay constant in this case is -0.547.</p>

<img src="figures/decay.png" style="width:100%;max-width:1000px;margin-top:32px;">
<p>Lastly, we plot the decay constant against all radii. It can be observed that the decay constant is negative for all radii, indicating magnetic field decay.</p>

    
<h3>Conclusions</h3>

<ul>
  <li><strong>Evolution of Magnetic Field Magnitude and Decay Rate:</strong>
    <ul>
      <li>The magnetic field magnitude consistently decays over time, as expected due to diffusion processes.</li>
      <li>The exponential decay rate is negative, thus our decay model is a good fit and can explain the field evolution. Thus we can conclude that the decay equation is a valid solution for \( \overline{B} \) </li>
   <li>The plot of \(\log_{10}\) scaled value of magnetic field against time was a straight line plot. The slopes are negative, because of the decay nature of field.</li>
    </ul>
  </li>
  
  <li><strong>Evolution of Spatial Solutions for \( \overline{B_r} \) and \(\overline{B_{\phi}} \), and Pitch Angle \( p \):</strong>
    <ul>
      <li>The spatial solutions for \( \overline{B_r} \) and \( \overline{B_{\phi}} \) follow an exponential decay pattern, though discrepancies in boundary conditions may affect accuracy.</li>
      <li>The pitch angle \( p \) of the mean magnetic field exhibits minimal variation over time. This might be because of the initial conditions we used to evolve \(r\) and \(\phi\) fields.</li>
    </ul>
  </li>
  
  <li><strong>Impact of Different Boundary Conditions:</strong>
    <ul>
      <li>Boundary conditions significantly influence magnetic field behavior, with challenges in maintaining integrity.</li>
      <li>Relative anti-symmetric ghost zones have limitations in preserving boundary conditions, especially with the complex diffusion equation.</li>
      <li>This is because in relative anti-symmetric ghost zones the double derivative is put to 0. This might work perfectly if we were solving in \(z\).But in this case, we have first and second derivatives as well as the field value as such in equation, thus the setting of second derivatives to 0 will not alone enforce the boundary conditions.</li>
    </ul>
  </li>
  
  <li><strong>Impact of Different Seed Fields:</strong>
    <ul>
      <li>Different seed fields influence magnetic field evolution, with consistent decay observed across implementations.</li>
      <li>Higher seed fields may exhibit slower diffusion rates. However, overall decay trends remain unchanged.</li>
    </ul>
  </li>
</ul>

  </div>
  </div>
<!-- Menu Container -->
<<div class="w3-container" id="menu">
  <div class="w3-content" style="max-width:700px">
    <h5 class="w3-center w3-padding-48"><span class="w3-tag w3-wide">REFERENCES AND LINKS</span></h5>
    <p>The link to my GitHub file which contains all the codes: <a href="https://github.com/gayathri2011067/MHD2011067/blob/main/Task_1__201067.ipynb">GitHub Repository</a></p>
    <p>The link to my project report: <a href="link-to-project-report">Project Report</a></p>
    <p>References:</p>
    <ul>
      <li>Class notes from P464 course</li>
      <li>Chapter 11 of Subramanian, Shukurov "Astrophysical Magnetic Fields"</li>
      <li>Chen, "Introduction to plasma" textbook</li>
      <li><a href="https://en.wikipedia.org/wiki/Dynamo_theory">Dynamo Theory Wikipedia</a></li>
    </ul>
  </div>
</div>


</body>
</html>
